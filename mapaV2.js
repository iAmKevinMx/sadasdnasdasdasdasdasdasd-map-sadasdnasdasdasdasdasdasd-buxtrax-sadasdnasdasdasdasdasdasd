var geocercas= [
  {
      "COORDINATES": "32.431482788224734,-117.03165946560017^32.43167295343362,-117.03082798080555^32.43038706658967,-117.0311069305431^32.43022406553941,-117.03189549999348^32.43022859335034,-117.03190086441151",
      "LOCATION_NAME": "ABC-ABC ALUMINIOS"
  },
  {
      "COORDINATES": "32.47454023798114,-116.8599745025075^32.47357381118276,-116.85959362882738^32.47361221244553,-116.85944878954058^32.4730745932763,-116.85864949125414^32.47402822507553,-116.85598873991137^32.47560905553723,-116.85665392774706^32.47475144245632,-116.86010324854021^32.47450823725984,-116.85996377367144^32.47450823725984,-116.85996377367144",
      "LOCATION_NAME": "APN-ALUMINIOS PLANTA NORTE"
  },
  {
      "COORDINATES": "32.455206106592264,-116.98126316070557^32.45607520120595,-116.9790530204773^32.45683565211528,-116.97976112365723^32.45587603443082,-116.98179960250854^32.455206106592264,-116.98137044906616^32.455206106592264,-116.98137044906616",
      "LOCATION_NAME": "BAX-BAXTER"
  },
  {
      "COORDINATES": "32.4377517063311,-116.86707051477133^32.43746421387428,-116.8670839258164^32.437455158978835,-116.8661827035874^32.43781509037147,-116.8661827035874^32.43779924436557,-116.86705978593527^32.437740387747795,-116.86707319698034^32.437740387747795,-116.86707319698034",
      "LOCATION_NAME": "BDR-BD REALITO"
  },
  {
      "COORDINATES": "32.49543796137859,-116.8487243376868^32.494935736729246,-116.84694871531894^32.49561894254691,-116.84665903674534^32.49529317618177,-116.84579000102451^32.49394032823716,-116.846417637934^32.4947638033221,-116.84897110091617^32.49544248591222,-116.84872970210483^32.49544248591222,-116.84872970210483",
      "LOCATION_NAME": "BEN-BENCHMARK"
  },
  {
      "COORDINATES": "32.43501888086015,-116.8640961244765^32.43583383982791,-116.86458965093524^32.43640430672234,-116.86324318200977^32.43568443123528,-116.86267455369861^32.435055101415145,-116.86410148889453^32.435055101415145,-116.86410148889453^32.435055101415145,-116.86410148889453",
      "LOCATION_NAME": "BIO-BIOTIX"
  },
  {
      "COORDINATES": "32.41947946768545,-117.02072835714273^32.41979645165966,-117.01908148080759^32.41862360539181,-117.01878643781595^32.41817076491499,-117.02022946626596^32.41945682593036,-117.0207229927247^32.41945682593036,-117.0207229927247",
      "LOCATION_NAME": "BOR-BORAL"
  },
  {
      "COORDINATES": "32.53332738943397,-116.92427973416383^32.53202938611857,-116.92469279435213^32.53157711574867,-116.92274551060731^32.53285703499886,-116.92232172158296^32.533331912060824,-116.92429046299989^32.533331912060824,-116.92429046299989",
      "LOCATION_NAME": "CAH-CARDINAL"
  },
  {
      "COORDINATES": "32.52569233597522,-116.96666126395071^32.525004835619065,-116.96628575468863^32.52558378363715,-116.96436529303396^32.52596371624664,-116.96426873350943^32.52641601487743,-116.96461205626333^32.52569233597522,-116.96667199278677^32.52569233597522,-116.96667199278677",
      "LOCATION_NAME": "CCS-CALL CENTER SERVICES"
  },
  {
      "COORDINATES": "32.585025240502304,-115.37574571977811^32.58644431464972,-115.37524682890134^32.58599686126248,-115.37376624952512^32.585395991771804,-115.37291330705838^32.584373225929504,-115.37326735864835^32.58480790283829,-115.37468892942624^32.585025240502304,-115.37574035536008^32.585025240502304,-115.37574035536008",
      "LOCATION_NAME": "CPM-PEPSICO MEXICALI"
  },
  {
      "COORDINATES": "32.584995401354696,-115.37573558460544^32.58361465854072,-115.37614864479373^32.58276446835889,-115.37379902969668^32.58434977888976,-115.37327331672977^32.58477167132402,-115.37461978565524^32.58500179363308,-115.37574094902347^32.58500179363308,-115.37574094902347",
      "LOCATION_NAME": "CSM-SABRITAS MEXICALI"
  },
  {
      "COORDINATES": "32.52504349009081,-116.96967585675193^32.52212155614671,-116.96911795727684^32.522239159038406,-116.96816309086753^32.521958721119475,-116.96780903927757^32.52216678804634,-116.96760519139244^32.522429132615265,-116.96747644535972^32.522718615388655,-116.96735842816307^32.52299000464173,-116.96731551281883^32.52324330053841,-116.96733697049095^32.52495302916493,-116.96770175091697^32.52495302916493,-116.96778758160545^32.52501635182261,-116.9679592429824^32.52511585876596,-116.96809871785118^32.52522441166938,-116.9681738197036^32.52504349009081,-116.96967585675193^32.52504349009081,-116.96967585675193",
      "LOCATION_NAME": "CUR-CURRENT"
  },
  {
      "COORDINATES": "32.48342917327744,-116.92311598857759^32.48324358726422,-116.92451073726534^32.48301320409466,-116.9253314932239^32.48049814946579,-116.92418350776552^32.480920529962866,-116.9230623443973^32.483435572788316,-116.92311062415956^32.483435572788316,-116.92311062415956",
      "LOCATION_NAME": "CZI-CARL ZEISS INSURGENTES"
  },
  {
      "COORDINATES": "32.545866594189064,-116.94652973632009^32.54593054483968,-116.94568215827138^32.545457308946446,-116.94562583188207^32.54530702405309,-116.94560437420995^32.545223887621034,-116.94652437190206^32.54586019912148,-116.94659410933644^32.545869791722666,-116.94650291422994^32.545869791722666,-116.94650291422994",
      "LOCATION_NAME": "CZO-CARL ZEISS OTAY"
  },
  {
      "COORDINATES": "32.54365183239942,-116.762926860498^32.54315439924787,-116.76038412635188^32.54743223428712,-116.75925759856563^32.546401231377494,-116.76199345176082^32.54467382277229,-116.76364569251399^32.54463764632052,-116.76367787902217^32.543669920825735,-116.76293758933406^32.543669920825735,-116.76293758933406",
      "LOCATION_NAME": "DAR-DART"
  },
  {
      "COORDINATES": "32.460764104353146,-116.99134316744323^32.46141588588337,-116.99088182749267^32.46094515525131,-116.98959436716552^32.4602571599022,-116.99004497828003^32.460764104353146,-116.99132170977111^32.460764104353146,-116.99132170977111",
      "LOCATION_NAME": "ELE-ELEVADORES"
  },
  {
      "COORDINATES": "32.43490804215834,-116.87613622529022^32.43334601496002,-116.87573389393799^32.43358598031784,-116.87455908638947^32.43512083797213,-116.87498287541382^32.43490804215834,-116.87613622529022^32.43490804215834,-116.87613622529022",
      "LOCATION_NAME": "ESE-ESTERLINE SENSORES"
  },
  {
      "COORDINATES": "32.4462583969619,-116.86395838795704^32.44543900518863,-116.8651224666695^32.445253396072516,-116.86497226296467^32.444886703768354,-116.86518147526783^32.44460149761141,-116.86433926163716^32.44461055178899,-116.86403885422749^32.44466940392111,-116.86373844681782^32.44570157352931,-116.86230614720387^32.445778533070396,-116.86237052022022^32.44544353223548,-116.86284795342488^32.44556123537343,-116.86298206387562^32.44550238382366,-116.86304643689198^32.446267450973025,-116.86394765912098^32.446267450973025,-116.86394765912098",
      "LOCATION_NAME": "ESS-ESSILOR"
  },
  {
      "COORDINATES": "32.53831502187905,-116.91121301648428^32.538495916729076,-116.90880975720694^32.53681358056049,-116.90856299397757^32.53600858060098,-116.90959296223929^32.535918130716425,-116.91061220166495^32.535176438227026,-116.91051564214041^32.53514930301981,-116.9108375072222^32.53831502187905,-116.91122374532034^32.53831502187905,-116.91122374532034",
      "LOCATION_NAME": "FLX-FLEX"
  },
  {
      "COORDINATES": "32.44800031877094,-116.88667394386903^32.44881017183111,-116.88738741146699^32.44967443386722,-116.88590414988175^32.448598906517084,-116.88508875834123^32.44759058796798,-116.88618041741029^32.44752656736173,-116.88631452786103^32.448003519785516,-116.88667930828706^32.448003519785516,-116.88667930828706",
      "LOCATION_NAME": "HNW-HONEYWELL"
  },
  {
      "COORDINATES": "32.46273964938057,-116.81016350765547^32.46170268433909,-116.8094124891313^32.46204514016388,-116.8087633945497^32.46306289838778,-116.80950368423781^32.46273324839843,-116.8101500966104^32.46273324839843,-116.8101500966104",
      "LOCATION_NAME": "HYC-YARDA HYUNDAI DC"
  },
  {
      "COORDINATES": "32.47653185866914,-116.80140760118343^32.47674908166197,-116.79860737497188^32.47597069684478,-116.79856445962764^32.47601595196028,-116.79811384851314^32.47496602742153,-116.79794218713619^32.47457682814539,-116.80113938028194^32.47653185866914,-116.80140760118343^32.47653185866914,-116.80140760118343",
      "LOCATION_NAME": "HYD-HYUNDAI DIE CASTING"
  },
  {
      "COORDINATES": "32.45258695917297,-116.87262622916438^32.45288798341355,-116.87041877114513^32.45239457473306,-116.87026588523128^32.45225877370462,-116.87033025824763^32.4519373771219,-116.87112419211604^32.451735937834215,-116.87248138987758^32.4525892225169,-116.87263159358241^32.4525892225169,-116.87263159358241",
      "LOCATION_NAME": "HYP-HYUNDAI POWER TRAIN"
  },
  {
      "COORDINATES": "32.37616380627946,-117.02931204611002^32.37299238427828,-117.029848487913^32.368026620008806,-117.0318655090922^32.368588453740664,-117.03765908056437^32.37661685748001,-117.03686514669596^32.37612756208531,-117.02933350378214^32.37612756208531,-117.02933350378214",
      "LOCATION_NAME": "HYR-HYUNDAI ROSARITO"
  },
  {
      "COORDINATES": "32.444873443305966,-116.88743524240539^32.44447279624618,-116.88729844974563^32.444683305940316,-116.88650988029525^32.44504094493859,-116.88666008400008^32.44487117976825,-116.88743524240539^32.44487797038119,-116.88743524240539^32.44487797038119,-116.88743524240539^32.44487797038119,-116.88743524240539",
      "LOCATION_NAME": "HYS-HYUNDAI SUB PLANTA"
  },
  {
      "COORDINATES": "32.451248168288636,-116.87398257266858^32.448106545462466,-116.873338842505^32.44764479915817,-116.87642874729016^32.44775344556025,-116.87666478168347^32.447336966974234,-116.87962594043591^32.45052388455673,-116.87912168514111^32.45123006126628,-116.87398257266858^32.45123006126628,-116.87398257266858",
      "LOCATION_NAME": "HYT-HYUNDAI TIJUANA"
  },
  {
      "COORDINATES": "32.46832955142971,-116.78427165829126^32.46899485579977,-116.78429848038141^32.46899485579977,-116.78334897839014^32.46827071475223,-116.78332752071802^32.46832502553279,-116.78426629387323^32.46832502553279,-116.78426629387323",
      "LOCATION_NAME": "HYY-YARDA HYUNDAI"
  },
  {
      "COORDINATES": "32.44958153839286,-116.98321044445038^32.44897975619413,-116.9835376739502^32.451009154554285,-116.98406338691711^32.451662137367336,-116.9835215806961^32.45250076521513,-116.98330163955688^32.45253277375695,-116.98219656944275^32.449831212806366,-116.98196589946747^32.44914620699159,-116.98213756084442^32.44903737381265,-116.9832694530487^32.449594342225765,-116.98321580886841^32.449594342225765,-116.98321580886841",
      "LOCATION_NAME": "INF-INFINEON"
  },
  {
      "COORDINATES": "32.54682393519772,-116.91883676343576^32.54558329679145,-116.91869728856699^32.545704803372054,-116.91690020852701^32.54693265011733,-116.91705577664987^32.546798355197495,-116.91883139901773^32.546798355197495,-116.91883139901773",
      "LOCATION_NAME": "ITG-INTEGER"
  },
  {
      "COORDINATES": "32.54496794486426,-116.91968020481472^32.545121427885476,-116.91744860691433^32.54279357387584,-116.91719647926693^32.542531366757665,-116.91939052624112^32.542531366757665,-116.91939052624112",
      "LOCATION_NAME": "ITG-INTEGER P2"
  },
  {
      "COORDINATES": "32.00346903350737,-116.840122750223^31.993788011320216,-116.85797553342613^31.985416378771554,-116.84166770261558^31.997063659547667,-116.82415824216636^32.00237724003677,-116.82870726865562^32.00332346179581,-116.84072356504234^32.00332346179581,-116.84072356504234",
      "LOCATION_NAME": "KEP-KEPLER ENSENADA"
  },
  {
      "COORDINATES": "32.550836912763934,-116.9075585248803^32.549028196495186,-116.90734394815911^32.548919672360114,-116.90883525637139^32.55073743431627,-116.90903910425652^32.55082786927325,-116.90756925371636^32.55082786927325,-116.90756925371636^32.55082786927325,-116.90756925371636",
      "LOCATION_NAME": "MAB-MABE"
  },
  {
      "COORDINATES": "32.53130449987328,-116.9040581015661^32.53114168148851,-116.9064184454992^32.53013310547374,-116.90629506388451^32.53037281290668,-116.90377378741051^32.53131806805866,-116.90405273714806^32.53131806805866,-116.90405273714806",
      "LOCATION_NAME": "MAB-MABE CEDIS"
  },
  {
      "COORDINATES": "32.44732507075706,-116.8906085086752^32.4497967527675,-116.88593073615323^32.45118195150268,-116.8870411706854^32.450023093885555,-116.88913329371701^32.44866051176431,-116.89013107547055^32.44842058653322,-116.89064069518338^32.44780492641384,-116.89090891608487^32.44733412466101,-116.89063533076535^32.44733412466101,-116.89063533076535",
      "LOCATION_NAME": "MAX-MAXON"
  },
  {
      "COORDINATES": "32.54539967989953,-116.91351828096685^32.5455082082899,-116.91229519365606^32.54330143856573,-116.9120484304267^32.54318386324707,-116.91322860239325^32.54318386324707,-116.91322860239325",
      "LOCATION_NAME": "MEC-MECALUX"
  },
  {
      "COORDINATES": "32.50590400454708,-116.92657226224097^32.5061890165521,-116.92539209027441^32.50475489936321,-116.92496830125006^32.50450607544041,-116.92616993088873^32.50590400454708,-116.92656153340491^32.50590400454708,-116.92656153340491",
      "LOCATION_NAME": "MED-MEDTRONIC"
  },
  {
      "COORDINATES": "32.457126256762365,-116.98095844280154^32.4568026143052,-116.9805909801665^32.4566373977774,-116.9808082390967^32.456963304062135,-116.98117033731371^32.45712399353243,-116.98095576059252^32.45712399353243,-116.98095576059252",
      "LOCATION_NAME": "MLB-MERCADO LIBRE"
  },
  {
      "COORDINATES": "32.48787585933713,-116.9020477225705^32.487939208112074,-116.90086755060395^32.48882608627827,-116.90097483896454^32.48874463864796,-116.90214428209504^32.48788490916483,-116.90205845140656^32.48788490916483,-116.90205845140656",
      "LOCATION_NAME": "MOR-MORGAN"
  },
  {
      "COORDINATES": "32.49690942913887,-116.8478458002568^32.49623075761684,-116.84797454628952^32.49502723419271,-116.84315729889877^32.497524753559404,-116.84239555153854^32.497090407346576,-116.8478458002568^32.497090407346576,-116.8478458002568",
      "LOCATION_NAME": "MPA-MOTORCARS PARTS"
  },
  {
      "COORDINATES": "32.45209976404877,-116.88498725088112^32.451284952141975,-116.88424696119301^32.45205449691393,-116.88290585668557^32.452706341461585,-116.88348521383278^32.45264296789308,-116.88412894399636^32.45210881747302,-116.884965793209^32.45210881747302,-116.884965793209",
      "LOCATION_NAME": "OCE-OCEANSIDE"
  },
  {
      "COORDINATES": "32.43308893960152,-116.87703175158602^32.43206568100952,-116.87668842883211^32.43251845173029,-116.87470359416109^32.43339682044511,-116.87496108622652^32.43304366291819,-116.87707466693026^32.433070828930916,-116.87704248042208^32.433070828930916,-116.87704248042208",
      "LOCATION_NAME": "REB-RECKITT BENCKISER"
  },
  {
      "COORDINATES": "32.45281698253823,-116.86564419907432^32.454110114039786,-116.86495218914848^32.45424454743782,-116.86520968121391^32.45341233746565,-116.86695311707359^32.45250329932736,-116.86878238362175^32.45200396461648,-116.86972115677696^32.451760697985605,-116.86980698746544^32.45158144846893,-116.86980698746544^32.45059556975307,-116.86959777516227^32.45058916790798,-116.86949585121971^32.45165826973402,-116.86965141934257^32.4519207418956,-116.8694207493673^32.452439282211394,-116.86839078110557^32.45273376056829,-116.86767731350761^32.452464889063236,-116.86732862633568^32.452663341918345,-116.86604116600853^32.452842589282724,-116.86563347023826^32.452842589282724,-116.86563347023826",
      "LOCATION_NAME": "SAM-SAMSUNG"
  },
  {
      "COORDINATES": "32.4459822491855,-116.86163127422333^32.44728602141788,-116.85975909233093^32.448272892023866,-116.86090171337128^32.44712305092032,-116.86253249645233^32.44783830813454,-116.86322450637817^32.44767081170103,-116.86346590518951^32.4459822491855,-116.86163663864136^32.4459822491855,-116.86163663864136",
      "LOCATION_NAME": "SCH-SCHLAGE"
  },
  {
      "COORDINATES": "32.53761347878219,-116.92120422072901^32.537597489642856,-116.92141343303217^32.536801226903684,-116.92128200479044^32.53651341935729,-116.92127127595438^32.53546451293804,-116.92138929315104^32.53543253389136,-116.9211854452659^32.53579069856376,-116.92114521213068^32.53583866693821,-116.92025203652872^32.537328871676564,-116.9203378672172^32.53725851921931,-116.92116130538477^32.53761028095455,-116.92121226735605^32.53761028095455,-116.92121226735605",
      "LOCATION_NAME": "SCN-SCHNEIDER"
  },
  {
      "COORDINATES": "32.56447329331446,-116.65015700082081^32.56370018905763,-116.65120306233662^32.56298133175391,-116.64821508149403^32.56435574572827,-116.6480112336089^32.5644913775448,-116.65025892476338^32.5644913775448,-116.65025892476338",
      "LOCATION_NAME": "SCT-SCHLAGE TECATE"
  },
  {
      "COORDINATES": "32.454311823463534,-116.8916544359048^32.452071242315256,-116.89034551790553^32.45312112156209,-116.88856453111964^32.45513122208292,-116.89006120374995^32.45432462662427,-116.89167052915889^32.45432462662427,-116.89167052915889^32.45432462662427,-116.89167052915889",
      "LOCATION_NAME": "SMA-SISTEMAS MEDICOS ALARIS"
  },
  {
      "COORDINATES": "32.44581306856996,-116.8676904180948^32.445577662798115,-116.86703327688615^32.44582212262581,-116.8668991664354^32.44606431828269,-116.86756971868913^32.44582212262581,-116.86770382913987^32.44579043342631,-116.86762068066041^32.44579043342631,-116.86761531624238",
      "LOCATION_NAME": "SMC-PEPSICO"
  },
  {
      "COORDINATES": "32.52960628198175,-116.96759957358938^32.52886431677828,-116.9675673870812^32.52844855773536,-116.96485299155813^32.52933124387108,-116.96480471179586^32.52933124387108,-116.96480471179586",
      "LOCATION_NAME": "SMI-SMITH MEDICAL"
  },
  {
      "COORDINATES": "32.54361323742833,-116.9096955317832^32.54379869884432,-116.90815057939062^32.54274987751834,-116.9078233498908^32.54253563506986,-116.90959897225866^32.54361323742833,-116.90969284957418^32.54361323742833,-116.90969284957418^32.54361323742833,-116.90969284957418",
      "LOCATION_NAME": "SOU-SOUTHFI"
  },
  {
      "COORDINATES": "32.46573579113801,-116.99367600167085^32.46449565115985,-116.99430900299836^32.46319212795689,-116.99036079132844^32.464368920565306,-116.98979216301728^32.465708634971016,-116.99367600167085^32.46576294729684,-116.99364381516267^32.46576294729684,-116.99364381516267",
      "LOCATION_NAME": "STG-STRYKER GF"
  },
  {
      "COORDINATES": "32.45220411202588,-116.97994022934887^32.453091342250204,-116.97942524521801^32.45385181834593,-116.97912483780834^32.455300326485016,-116.98044448464367^32.45472997918491,-116.98146372406933^32.453842765096844,-116.98048739998791^32.45220411202588,-116.97995095818493^32.45220411202588,-116.97995095818493",
      "LOCATION_NAME": "STJ-ST JOHN"
  },
  {
      "COORDINATES": "32.49753156151776,-116.94890951597357^32.49515168066918,-116.95105528318548^32.4942829632278,-116.94982146703863^32.49675335645784,-116.94753622495794^32.49675335645784,-116.94753622495794",
      "LOCATION_NAME": "STP-STRYKER P1"
  },
  {
      "COORDINATES": "32.49445796345312,-116.95880107860259^32.493991930191534,-116.95800714473418^32.49541264541117,-116.95683770160369^32.4958786713124,-116.95762627105407^32.49446248803604,-116.95881180743865^32.494467012618756,-116.95881180743865",
      "LOCATION_NAME": "STP-STRYKER P3"
  },
  {
      "COORDINATES": "32.43490310746473,-116.98460178782615^32.435102320592904,-116.9843764822689^32.43486915063762,-116.983853451511^32.434633716284516,-116.98406802823219^32.43490989882861,-116.98460178782615^32.43490989882861,-116.98460178782615",
      "LOCATION_NAME": "THD-THE HOME DEPOT"
  },
  {
      "COORDINATES": "32.486727442648885,-117.03617861385845^32.48628589148379,-117.03486701365017^32.48546997602133,-117.03493406887554^32.48533878892326,-117.03495552654766^32.485370785794075,-117.03627249117397^32.48673384192519,-117.03617593164944^32.4867306422871,-117.03617593164944",
      "LOCATION_NAME": "THE-THERMOFISHER"
  },
  {
      "COORDINATES": "32.49566706912946,-116.71780650052375^32.49595663808647,-116.7198878947193^32.49595663808647,-116.7198878947193^32.49999240838692,-116.71774212750739^32.499775241501055,-116.71664778622932^32.49564897103869,-116.71780650052375^32.49564897103869,-116.71780650052375",
      "LOCATION_NAME": "TOY-TOYOTA"
  },
  {
      "COORDINATES": "32.427150121176126,-116.87863717812532^32.42665204360918,-116.87852184313768^32.427014282112474,-116.87714318770402^32.42718634489188,-116.8772665693187^32.42732897563121,-116.87752942580217^32.42741274278571,-116.87773863810533^32.42741274278571,-116.8779129816913^32.42738557506844,-116.87807123202317^32.42718634489188,-116.87854061860078^32.42718634489188,-116.87854061860078",
      "LOCATION_NAME": "TPK-TRANSPAK"
  },
  {
      "COORDINATES": "32.4954025008453,-116.71747666331541^32.495542761337795,-116.71832424136412^32.49454735956288,-116.71863001319181^32.49438447458738,-116.71781998606932^32.49539797630964,-116.71747129889738^32.49539797630964,-116.71747129889738",
      "LOCATION_NAME": "TRI-TRIGO"
  },
  {
      "COORDINATES": "32.44709036569602,-116.86256200987047^32.4462890895058,-116.86170370298571^32.447466102924786,-116.86001927572435^32.44827189555471,-116.86092586237139^32.44708131176757,-116.86258883196062^32.44708131176757,-116.86258883196062",
      "LOCATION_NAME": "TRU-TRUPER TIJUANA"
  },
  {
      "COORDINATES": "32.61157951545312,-115.42701010057293^32.6114708788889,-115.42605791637264^32.61074237146506,-115.4260310942825^32.61079988542453,-115.42701010057293^32.61157951545312,-115.4269859606918^32.611582710644186,-115.42698059627376^32.611582710644186,-115.42698059627376",
      "LOCATION_NAME": "TVM-TELVISTA MEXICALI"
  },
  {
      "COORDINATES": "32.513531945313346,-117.00940391111443^32.51313160374925,-117.00958093690942^32.51293256321202,-117.00889160919259^32.513351000194454,-117.00873604106972^32.51353646893666,-117.00940391111443^32.51353646893666,-117.00940391111443",
      "LOCATION_NAME": "TVT-TELVISTA TIJUANA"
  },
  {
      "COORDINATES": "32.53104746783034,-116.95915639400482^32.53019038329646,-116.95852875709534^32.52996012038629,-116.95894718170166^32.530331099228746,-116.95923149585724^32.52861051201769,-116.96248233318329^32.52862330460927,-116.96323335170746^32.52924374311355,-116.96316361427307^32.52923734686218,-116.96229994297028^32.53106026007485,-116.95916712284088^32.53106026007485,-116.95916712284088",
      "LOCATION_NAME": "TYC-TYCO"
  },
  {
      "COORDINATES": "32.52435919082345,-116.90056409052181^32.525075607045146,-116.89759756735134^32.52677067625064,-116.89816083124447^32.52602868762822,-116.90087522676754^32.52438477721545,-116.90056945493984^32.52438477721545,-116.90056945493984",
      "LOCATION_NAME": "WEL-WELCH ALLYN"
  }
]

let markers = [];
let polygons = [];
var trafico_on_off = 0;
var a = 0, a2 = 0, a3 = 0, a4 = 0, a5 = 0, a6 = 0, a7 = 0, a8 = 0, a9 = 0, a10 = 0, a11 = 0, a12 = 0, a13 = 0, a14 = 0, a15 = 0, a16 = 0;

var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 13,
    center: {lat: 32.453802, lng: -116.919213},
    mapTypeControl: false,
    streetViewControl: false,
    mapTypeControlOptions: {
        style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
    },
    zoomControlOptions: {
        position: google.maps.ControlPosition.TOP_RIGHT
    },
    fullscreenControlOptions : {
        position: google.maps.ControlPosition.RIGHT_TOP
    }

});

var trafficLayer = new google.maps.TrafficLayer();
setInterval(function() {
    map.setOptions({
        styles: [{
        "featureType": "road",
        "elementType": "geometry.fill",
        "stylers": [{
            "saturation": Math.random()
        }]
        }]
    })
    //console.log("recargado");
    },
    120000 //reload tiles  every 30 sec 120000
);
trafficLayer.setMap(map);

document.getElementById("trafico").addEventListener("click", function() {
  if(trafico_on_off===0){
    trafficLayer.setMap(null);
    trafico_on_off = 1;
  } else{
    trafficLayer.setMap(map);
    trafico_on_off = 0;
  }
});

document.getElementById('mapa_hibrido').addEventListener('click', function() {
      map.setMapTypeId(google.maps.MapTypeId.HYBRID); // cambiar a satélite
});

document.getElementById('mapa_regular').addEventListener('click', function() {
    map.setMapTypeId(google.maps.MapTypeId.ROADMAP); // cambiar a mapa
});

var icono = new google.maps.MarkerImage(
    url = '',
    new google.maps.Size(35, 35),
    new google.maps.Point(0, 0),
    new google.maps.Point(17.5, 17.5),
    new google.maps.Size(35, 35)
);



  function eliminarMarcadores() {
    
    markers.forEach(function(marker) {
        marker.setMap(null);
    });
    
    polygons.forEach(function(polygon) {
        polygon.setMap(null);
    });
    
    // Vacia los arreglos de markers y polygons
    markers = [];
    polygons = [];


  }
  
  google.maps.Polygon.prototype.getBoundingBox = function() {
    var bounds = new google.maps.LatLngBounds();
  
  
    this.getPath().forEach(function(element,index) {
      bounds.extend(element)
    });
  
  
    return(bounds);
  };



  function addMarkers2(perfiles_filtrados) {
    if(document.querySelector('#planta').value != ""){
    //   var objetoBuscado = geocercas.find(function(objeto) {
    //     return objeto.LOCATION_NAME.includes(document.querySelector('#planta').value);
    //   });
        let objetosBuscados = [];
        objetosBuscados = geocercas.filter((geocerca) => geocerca.LOCATION_NAME.includes(document.querySelector('#planta').value));
        //console.log(objetosBuscados);
        objetosBuscados.forEach(objetoBuscado => {
            if(objetoBuscado != undefined){
                //console.log(objetoBuscado); // muestra el primer objeto que contiene "APN-" en su LOCATION_NAME
                //console.log(objetoBuscado.COORDINATES); // muestra la propiedad COORDINATES del objeto encontrado
                //console.log(objetoBuscado.LOCATION_NAME); // muestra la propiedad LOCATION_NAME del objeto encontrado
        
                // Separa las coordenadas en una matriz de puntos
                var vertices = objetoBuscado.COORDINATES.split('^').map(function(coordenada) {
                    var coordenadaArray = coordenada.split(',');
                    var lat = parseFloat(coordenadaArray[0]);
                    var lng = parseFloat(coordenadaArray[1]);
                    return new google.maps.LatLng(lat, lng);
                });
        
                // Crea un objeto Polygon y configura sus propiedades
                var polygon = new google.maps.Polygon({
                    paths: vertices,
                    strokeColor: '#FF0000',
                    strokeOpacity: 0.8,
                    strokeWeight: 2,
                    fillColor: '#FF0000',
                    fillOpacity: 0.35
                });


                // Agrega el polígono al mapa
                polygon.setMap(map);
                polygons.push(polygon);
                //objetoBuscado.LOCATION_NAME.substring(0, 3)

                var longitud_geocerca;


                if(document.getElementById("select_geocerca").value === '0'){
                    longitud_geocerca = objetoBuscado.LOCATION_NAME;
                } else {
                    longitud_geocerca = objetoBuscado.LOCATION_NAME.substring(0, 3)
                }
                

                var label = new MarkerWithLabel({
                    position: polygon.getBoundingBox().getNorthEast(),
                    map: map,
                    icon: 'img_vacio.png',
                    labelContent: '<div class="tooltip_geo">' + longitud_geocerca + '</div>',
                    labelAnchor: new google.maps.Point(0, 0),
                });

                

                markers.push(label);
              }
          });

    }
  
    perfiles_filtrados.forEach((item) => {
      const carro = ubicaciones.find(obj => obj.trip === item.trip);
      const carro_velocidades = velocidades.find(obj => obj.id === item.trip);
      //if colocado para evitar error en caso de que el ID car de VL no se encuentre en la flota
      if (carro!=undefined){
        const lat = parseFloat(carro_velocidades.lat);
        const lng = parseFloat(carro_velocidades.lng);
        const angulo = carro_velocidades.direction;
        var marker, marker2;
        var contentString = carro.lgprs.replace("T"," ").replace(/%3A/g);

        if(carro.led === "Ignition Off"){
            icono.url = 'c_blanco.png?v=1.0';
            marker = new MarkerWithLabel({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                icon: icono,
                title: contentString,
                labelContent: '<div class="custom-tooltip">' + carro.car + '</div>',
                labelAnchor: new google.maps.Point(22, 34),
            });
        } else if (carro.led != "Ignition Off" && carro_velocidades.speed ==="0.00"){
            icono.url = 'c_verde.png?v=1.0';
            marker = new MarkerWithLabel({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                icon: icono,
                title: contentString,
                labelContent: '<div class="custom-tooltip">' + carro.car + '</div>',
                labelAnchor: new google.maps.Point(22, 34),
            });
        } else {
            if (angulo > 348.75 || angulo <= 11.25) {
                icono.url = 'camion_azul/c_azul_1.png?v=1.0';
                a++;
            } else if (angulo > 11.25 && angulo <= 191.25) {
                if (angulo > 11.25 && angulo <= 191.25) {
                    if (angulo > 11.25 && angulo <= 101.25) {
                        if (angulo > 11.25 && angulo <= 33.75) {
                            icono.url = 'camion_azul/c_azul_2.png?v=1.0';
                            a2++;
                        } else if (angulo > 33.75 && angulo <= 56.25) {
                            icono.url = 'camion_azul/c_azul_3.png?v=1.0';
                            a3++;
                        } else if (angulo > 56.25 && angulo <= 78.75) {
                            icono.url = 'camion_azul/c_azul_4.png?v=1.0';
                            a4++;
                        } else if (angulo > 78.75 && angulo <= 101.25) {
                            icono.url = 'camion_azul/c_azul_5.png?v=1.0';
                            a5++;
                        }
                    } else if (angulo > 101.25 && angulo <= 191.25) {
                        if (angulo > 101.25 && angulo <= 123.75) {
                            icono.url = 'camion_azul/c_azul_6.png?v=1.0';
                            a6++;
                        } else if (angulo > 123.75 && angulo <= 146.25) {
                            icono.url = 'camion_azul/c_azul_7.png?v=1.0';
                            a7++;
                        } else if (angulo > 146.25 && angulo <= 168.75) {
                            icono.url = 'camion_azul/c_azul_8.png?v=1.0';
                            a8++;
                        } else if (angulo > 168.75 && angulo <= 191.25) {
                            icono.url = 'camion_azul/c_azul_9.png?v=1.0';
                            a9++;
                        }
                    } 
                } 
            }else if (angulo > 191.25 && angulo <= 348.75) {
                if (angulo > 191.25 && angulo <= 281.25) {
                    if (angulo > 191.25 && angulo <= 213.75) {
                        icono.url = 'camion_azul/c_azul_10.png?v=1.0';
                        a10++;
                    } else if (angulo > 213.75 && angulo <= 236.25) {
                        icono.url = 'camion_azul/c_azul_11.png?v=1.0';
                        a11++;
                    } else if (angulo > 236.25 && angulo <= 258.75) {
                        icono.url = 'camion_azul/c_azul_12.png?v=1.0';
                        a12++;
                    } else if (angulo > 258.75 && angulo <= 281.25) {
                        icono.url = 'camion_azul/c_azul_13.png?v=1.0';
                        a13++;
                    } 
                } else if (angulo > 281.25 && angulo <= 348.75) {
                    if (angulo > 281.25 && angulo <= 303.75) {
                        icono.url = 'camion_azul/c_azul_14.png?v=1.0';
                        a14++;
                    } else if (angulo > 303.75 && angulo <= 326.25) {
                        icono.url = 'camion_azul/c_azul_15.png?v=1.0';
                        a15++;
                    } else if (angulo > 326.25 && angulo <= 348.75) {
                        icono.url = 'camion_azul/c_azul_16.png?v=1.0';
                        a16++;
                    }
                } 
            }
                
            //console.log(angulo);
            marker = new MarkerWithLabel({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                icon: icono,
                title: contentString,
                labelContent: '<div class="custom-tooltip">' + carro.car + '</div>',
                labelAnchor: new google.maps.Point(22, 34),
            });
        }
        
            markers.push(marker);

            };

    });
}
  
function centrarMapa(marcadores, poligonos) {
    // Crear un objeto de límites vacío.
    var limites = new google.maps.LatLngBounds();

    // Iterar por cada marcador y extender los límites del objeto.
    for (var i = 0; i < marcadores.length; i++) {
      limites.extend(marcadores[i].getPosition());
    }

    // Iterar por cada polígono y extender los límites del objeto.
    for (var i = 0; i < poligonos.length; i++) {
      var coords = poligonos[i].getPath();
      for (var j = 0; j < coords.getLength(); j++) {
        limites.extend(coords.getAt(j));
      }
    }

    // Centrar el mapa en el centro de los límites.
    map.setCenter(limites.getCenter());

    // Establecer el nivel de zoom del mapa para mostrar todos los marcadores y polígonos.
    map.fitBounds(limites);
}
  
  
  

function actualizarMapa(){
  eliminarMarcadores();
  filtrarObjetos();
  addMarkers2(objetosFiltrados);
}


